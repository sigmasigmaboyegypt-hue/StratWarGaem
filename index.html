<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Circle Battle Simulator - Modern Map</title>
<style>
    /* Reset */
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: 'Segoe UI', sans-serif; background: #121212; color: #fff; overflow: hidden; }

    /* Header */
    .header { display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; background: #1f1f1f; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
    .header h1 { color: #f1c40f; font-size: 1.5rem; }
    .header .buttons { display: flex; gap: 10px; }
    .header button { border:none; padding:6px 14px; border-radius:5px; font-weight:bold; cursor:pointer; transition:0.2s; }
    .red-btn { background:#e74c3c;} .blue-btn{background:#3498db;} .delete-btn{background:#7f8c8d;} .start-btn{background:#2ecc71;} .pause-btn{background:#e67e22;}
    .header button:hover{filter:brightness(1.2);}

    /* Notification */
    #placingNotification { position:absolute; top:60px; left:50%; transform:translateX(-50%); background:#333; padding:5px 12px; border-radius:5px; font-weight:bold; color:#f1c40f; box-shadow:0 2px 8px rgba(0,0,0,0.7); }

    /* Canvas */
    #gameCanvas { display:block; margin: 80px auto 0 auto; background: linear-gradient(135deg,#1a1a1a,#2a2a2a); border-radius:10px; box-shadow:0 0 20px rgba(0,0,0,0.7); }
</style>
</head>
<body>

<div class="header">
    <h1>Circle Battle Simulator</h1>
    <div class="buttons">
        <button class="red-btn" id="placeRed">Red</button>
        <button class="blue-btn" id="placeBlue">Blue</button>
        <button class="delete-btn" id="deleteTool">Delete</button>
        <button class="start-btn" id="startBtn">Start</button>
        <button class="pause-btn" id="pauseBtn">Pause</button>
    </div>
</div>

<div id="placingNotification">Placing: Red</div>
<canvas id="gameCanvas" width="1000" height="600"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const placingNotification = document.getElementById('placingNotification');

// Game State
let placingMode = 'red'; // red, blue, delete
let gameRunning = false;
let circles = [];
let selectedCircle = null;

// Circle Class
class Circle {
    constructor(x,y,team){
        this.x=x; this.y=y;
        this.team=team;
        this.radius=20;
        this.health=100;
        this.speed = team==='red'?1.8:2;
        this.attackPower=team==='red'?10:12;
        this.target=null;
        this.isMoving=false;
    }

    draw(){
        // Circle
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);
        ctx.fillStyle = this.team==='red'?'#e74c3c':'#3498db';
        ctx.fill();
        if(this===selectedCircle){ ctx.strokeStyle='#f1c40f'; ctx.lineWidth=3; ctx.stroke();}

        // Health Bar
        ctx.fillStyle='#333';
        ctx.fillRect(this.x-25,this.y-this.radius-15,50,8);
        ctx.fillStyle=this.health>60?'#2ecc71':this.health>30?'#f39c12':'#e74c3c';
        ctx.fillRect(this.x-25,this.y-this.radius-15,50*(this.health/100),8);
        ctx.strokeStyle='#fff'; ctx.lineWidth=1;
        ctx.strokeRect(this.x-25,this.y-this.radius-15,50,8);
    }

    move(){
        if(this.isMoving && this.target){
            let dx=this.target.x-this.x;
            let dy=this.target.y-this.y;
            let dist=Math.sqrt(dx*dx+dy*dy);
            if(dist>this.speed){ this.x+=dx/dist*this.speed; this.y+=dy/dist*this.speed; }
            else{ this.x=this.target.x; this.y=this.target.y; this.isMoving=false; }
        }
        // Stay in bounds
        this.x=Math.max(this.radius, Math.min(canvas.width-this.radius,this.x));
        this.y=Math.max(this.radius, Math.min(canvas.height-this.radius,this.y));
    }

    attack(target){
        if(target && this.health>0 && target.health>0){
            target.health-=this.attackPower*0.05;
        }
    }

    isColliding(other){
        let dx=this.x-other.x;
        let dy=this.y-other.y;
        return Math.sqrt(dx*dx+dy*dy)<this.radius+other.radius;
    }
}

// Draw Grid + Bases
function drawMap(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // Grid
    ctx.strokeStyle='rgba(255,255,255,0.05)'; ctx.lineWidth=1;
    for(let x=0;x<=canvas.width;x+=50){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,canvas.height);ctx.stroke();}
    for(let y=0;y<=canvas.height;y+=50){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(canvas.width,y);ctx.stroke();}
    // Bases
    ctx.fillStyle='rgba(231,76,60,0.1)'; ctx.fillRect(0,0,100,canvas.height);
    ctx.fillStyle='rgba(52,152,219,0.1)'; ctx.fillRect(canvas.width-100,0,100,canvas.height);
}

// Game Loop
function gameLoop(){
    drawMap();
    // Move & AI
    if(gameRunning){
        circles.forEach(c=>{
            if(c!==selectedCircle){
                // Simple AI: chase nearest enemy
                let enemies=circles.filter(e=>e.team!==c.team && e.health>0);
                if(enemies.length>0){
                    let target=enemies.reduce((a,b)=>((Math.hypot(a.x-c.x,a.y-c.y)<Math.hypot(b.x-c.x,b.y-c.y))?a:b));
                    let dx=target.x-c.x; let dy=target.y-c.y; let dist=Math.sqrt(dx*dx+dy*dy);
                    if(dist>c.radius+target.radius){ c.x+=dx/dist*c.speed; c.y+=dy/dist*c.speed; }
                    c.attack(target);
                }
            }
            c.move();
            c.draw();
        });
    } else { circles.forEach(c=>c.draw()); }

    // Remove dead
    circles=circles.filter(c=>c.health>0);

    requestAnimationFrame(gameLoop);
}

// Canvas Click
canvas.addEventListener('click',(e)=>{
    const rect=canvas.getBoundingClientRect();
    const x=e.clientX-rect.left; const y=e.clientY-rect.top;
    if(placingMode==='red'||placingMode==='blue'){
        circles.push(new Circle(x,y,placingMode));
    } else if(placingMode==='delete'){
        circles=circles.filter(c=>Math.hypot(c.x-x,c.y-y)>c.radius);
    }
});

// UI Buttons
document.getElementById('placeRed').onclick=()=>{placingMode='red'; placingNotification.textContent='Placing: Red';}
document.getElementById('placeBlue').onclick=()=>{placingMode='blue'; placingNotification.textContent='Placing: Blue';}
document.getElementById('deleteTool').onclick=()=>{placingMode='delete'; placingNotification.textContent='Delete Tool Active';}
document.getElementById('startBtn').onclick=()=>{gameRunning=true;}
document.getElementById('pauseBtn').onclick=()=>{gameRunning=false;}

gameLoop();
</script>
</body>
</html>
